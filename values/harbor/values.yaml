## Harbor HA Configuration

expose:
  type: ingress
  tls:
    enabled: true
    certSource: secret
    secret:
      secretName: harbor-tls
  ingress:
    hosts:
      core: harbor.thanhtamhcmut.site
    className: nginx
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
      nginx.ingress.kubernetes.io/proxy-body-size: "0"

externalURL: https://harbor.thanhtamhcmut.site

## Persistence với S3 Storage (MinIO)
persistence:
  enabled: true
  resourcePolicy: "keep"
  imageChartStorage:
    disableredirect: true
    type: s3
    s3:
      region: us-east-1
      bucket: harbor
      accesskey: admin
      secretkey: minioadmin
      regionendpoint: http://minio.minio.svc.cluster.local:9000
      secure: false
      v4auth: true
  persistentVolumeClaim:
    registry:
      size: 1Gi
    jobservice:
      jobLog:
        size: 1Gi

## External PostgreSQL
database:
  type: external
  external:
    host: postgres-ha-rw.postgres.svc.cluster.local
    port: "5432"
    username: harbor
    password: harbor
    coreDatabase: harbor
    sslmode: disable

## External Redis - Direct connection (không dùng Sentinel)
redis:
  type: external
  external:
    addr: redis-master.redis.svc.cluster.local:6379
    password: password
    sentinelMasterSet: ""

## Disable internal database and redis
postgresql:
  enabled: false

## Core service
core:
  replicas: 2
  resources:
    requests:
      memory: 256Mi
      cpu: 100m
    limits:
      memory: 512Mi
      cpu: 500m
  configOverwrite:
    SCAN_ON_PUSH: "true"

## Job Service - 1 replica vì dùng RWO PVC
jobservice:
  replicas: 1
  resources:
    requests:
      memory: 256Mi
      cpu: 100m
    limits:
      memory: 512Mi
      cpu: 500m

## Registry - HA với S3 storage
registry:
  replicas: 2
  resources:
    requests:
      memory: 256Mi
      cpu: 100m
    limits:
      memory: 512Mi
      cpu: 500m

## Portal
portal:
  replicas: 2
  resources:
    requests:
      memory: 128Mi
      cpu: 100m
    limits:
      memory: 256Mi
      cpu: 200m

## Trivy
trivy:
  enabled: true
  replicas: 1
  resources:
    requests:
      memory: 256Mi
      cpu: 100m
    limits:
      memory: 1Gi
      cpu: 500m

## Notary - disable
notary:
  enabled: false

## Metrics
metrics:
  enabled: false

## Harbor admin password
harborAdminPassword: "Harbor12345"